<?xml version="1.0" encoding="UTF-8"?>
<job>
  <name>Sample_Pipeline1_ETL_MainJob</name>
    <description/>
    <extended_description/>
    <job_version/>
    <job_status>0</job_status>
  <directory>&#x2f;</directory>
  <created_user>-</created_user>
  <created_date>2011&#x2f;10&#x2f;05 11&#x3a;53&#x3a;46.318</created_date>
  <modified_user>-</modified_user>
  <modified_date>2011&#x2f;10&#x2f;05 11&#x3a;53&#x3a;46.318</modified_date>
    <parameters>
    </parameters>
  <connection>
    <name>LAP_connect</name>
    <server>localhost</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>oaai</database>
    <port>3306</port>
    <username>root</username>
    <password>Encrypted 2be98afc86aa7f289b20abf7cce85ab8b</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
         <slaveserver><name>localhost</name><hostname>localhost</hostname><port>8085</port><webAppName/><username>cluster</username><password>Encrypted 2be98afc86aa7f2e4cb1aa265cd86aac8</password><proxy_hostname/><proxy_port/><non_proxy_hosts/><master>Y</master></slaveserver>
    </slaveservers>
<job-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_JOB</id><enabled>Y</enabled><name>ID_JOB</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>JOBNAME</id><enabled>Y</enabled><name>JOBNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>START_JOB_ENTRY</id><enabled>N</enabled><name>START_JOB_ENTRY</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></job-log-table>
<jobentry-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>JOBNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>JOBENTRYNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>RESULT</id><enabled>Y</enabled><name>RESULT</name></field><field><id>NR_RESULT_ROWS</id><enabled>Y</enabled><name>NR_RESULT_ROWS</name></field><field><id>NR_RESULT_FILES</id><enabled>Y</enabled><name>NR_RESULT_FILES</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field><field><id>COPY_NR</id><enabled>N</enabled><name>COPY_NR</name></field></jobentry-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>161</xloc>
      <yloc>46</yloc>
      </entry>
    <entry>
      <name>Calculate Aptitude Score</name>
      <description/>
      <type>SQL</type>
      <sql>---------------------------------------------------------------------&#xd;&#xa;-- Queries to convert ACT_Composite score to equivalent SAT scores.&#xd;&#xa;-- &#xd;&#xa;---------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;UPDATE DISTINCT_PERSONAL&#xd;&#xa;   SET APTITUDE_SCORE &#x3d;&#xd;&#xa;   CASE &#xd;&#xa;      WHEN ACT_COMPOSITE&#x3d;36 THEN 1600&#xd;&#xa;      WHEN ACT_COMPOSITE&#x3d;35 THEN 1560&#xd;&#xa;      WHEN ACT_COMPOSITE&#x3d;34 THEN 1510&#xd;&#xa;      WHEN ACT_COMPOSITE&#x3d;33 THEN 1460&#xd;&#xa;      WHEN ACT_COMPOSITE&#x3d;32 THEN 1420&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;31 THEN 1380&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;30 THEN 1340&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;29 THEN 1300&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;28 THEN 1260&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;27 THEN 1220&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;26 THEN 1190&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;25 THEN 1150&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;24 THEN 1110&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;23 THEN 1070&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;22 THEN 1030&#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;21 THEN 990&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;20 THEN 950&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;19 THEN 910&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;18 THEN 870 &#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;17 THEN 830 &#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;16 THEN 790&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;15 THEN 740 &#xd;&#xa;    WHEN ACT_COMPOSITE&#x3d;14 THEN 690&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;13 THEN 640&#xd;&#xa;     WHEN ACT_COMPOSITE&#x3d;12 THEN 590&#xd;&#xa;   WHEN ACT_COMPOSITE&#x3d;11 THEN 530&#xd;&#xa;   WHEN SAT_MATH is not null&#xd;&#xa;      and SAT_VERBAL  is not null THEN SAT_VERBAL &#x2b; SAT_MATH&#xd;&#xa;    WHEN SAT_MATH is not null&#xd;&#xa;      and SAT_VERBAL is not null&#xd;&#xa;      and ACT_COMPOSITE is not null THEN SAT_VERBAL &#x2b; SAT_MATH&#xd;&#xa;END&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>513</xloc>
      <yloc>154</yloc>
      </entry>
    <entry>
      <name>PC</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;----------------------------------------------------------------------------------&#xd;&#xa;-- First stage of merging. Includes merging of Demographics &#x28;BIO&#x29; table and   &#xd;&#xa;-- Course Enrollment table. For our analysis we are deleting the letter grades&#xd;&#xa;-- which are not valid. Technically for scoring purposes we wont have the &#xd;&#xa;-- grade information since we will be predicting it. So we can eliminate &#xd;&#xa;-- the delete query for grade info&#xd;&#xa;---------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PC&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE PC&#xd;&#xa;SELECT  P.ALTERNATIVE_ID,&#xd;&#xa;C.COURSE_ID,&#xd;&#xa;C.SUBJECT,&#xd;&#xa;C.ONLINE_FLAG,&#xd;&#xa;C.ENROLLMENT,&#xd;&#xa;C.FINAL_GRADE,&#xd;&#xa;P.PERCENTILE,&#xd;&#xa;P.SAT_VERBAL,&#xd;&#xa;P.SAT_MATH,&#xd;&#xa;P.ACT_COMPOSITE,&#xd;&#xa;P.APTITUDE_SCORE,&#xd;&#xa;P.AGE,&#xd;&#xa;P.GENDER,&#xd;&#xa;P.ENROLLMENT_STATUS,&#xd;&#xa;P.CLASS_CODE,&#xd;&#xa;P.GPA_CUMULATIVE,&#xd;&#xa;P.GPA_SEMESTER,&#xd;&#xa;P.STANDING&#xd;&#xa;FROM DISTINCT_PERSONAL  P&#xd;&#xa;INNER JOIN DISTINCT_COURSE  C&#xd;&#xa;&#xd;&#xa;ON P.ALTERNATIVE_ID &#x3d;C.ALTERNATIVE_ID&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE PC ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>495</xloc>
      <yloc>368</yloc>
      </entry>
    <entry>
      <name>Recodin</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Recoding Gender information into numeric for data mining purposes&#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xa;UPDATE PC &#xd;&#xa;       SET GENDER &#x3d; CASE&#xd;&#xa;     WHEN GENDER &#x3d; &#x27;F&#x27; THEN &#x27;1&#x27;&#xd;&#xa;     WHEN GENDER &#x3d; &#x27;M&#x27; THEN &#x27;2&#x27;&#xd;&#xa;     ELSE NULL&#xd;&#xa;   END&#x3b;&#xd;&#xa;     &#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Recoding Gender information into Full time- Part time status&#xd;&#xa;-- for data mining purposes&#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;UPDATE PC &#xd;&#xa;       SET ENROLLMENT_STATUS &#x3d; CASE&#xd;&#xa;      WHEN ENROLLMENT_STATUS &#x3d; &#x27;F&#x27; THEN &#x27;1&#x27;&#xd;&#xa;      WHEN ENROLLMENT_STATUS &#x3d; &#x27;P&#x27; THEN &#x27;2&#x27;&#xd;&#xa;      ELSE NULL&#xd;&#xa;   END&#x3b;&#xd;&#xa;&#xa;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Recoding Gender information into Class year&#xd;&#xa;-- for data mining purposes&#xd;&#xa;-- Varies for different intitution type&#xd;&#xa;--&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;UPDATE PC &#xd;&#xa;       SET CLASS_CODE &#x3d; CASE&#xd;&#xa;      WHEN CLASS_CODE &#x3d; &#x27;FR&#x27; THEN &#x27;1&#x27;&#xd;&#xa;      WHEN CLASS_CODE &#x3d; &#x27;SO&#x27; THEN &#x27;2&#x27;&#xd;&#xa;      WHEN CLASS_CODE &#x3d; &#x27;JR&#x27; THEN &#x27;3&#x27;&#xd;&#xa;      WHEN CLASS_CODE &#x3d; &#x27;SR&#x27; THEN &#x27;4&#x27;&#xd;&#xa;      WHEN CLASS_CODE &#x3d; &#x27;GR&#x27; THEN &#x27;5&#x27;&#xd;&#xa;      ELSE NULL&#xd;&#xa;   END&#x3b;&#xa;&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Recoding Letter Grade information to Numeric GPA &#xd;&#xa;-- for data mining purposes&#xd;&#xa;--&#xd;&#xa;-- These adhere to Marist grading policy. Might change if deployed elsewhere&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;UPDATE PC &#xd;&#xa;       SET FINAL_GRADE &#x3d; CASE&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;A&#x27;  THEN &#x27;4.0&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;A-&#x27; THEN &#x27;3.7&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;B&#x2b;&#x27; THEN &#x27;3.3&#x27;&#xd;&#xa;      WHEN FINAL_GRADE &#x3d; &#x27;B&#x27;  THEN &#x27;3.0&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;B-&#x27; THEN &#x27;2.7&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;C&#x2b;&#x27; THEN &#x27;2.3&#x27;&#xd;&#xa;      WHEN FINAL_GRADE &#x3d; &#x27;C&#x27;  THEN &#x27;2.0&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;C-&#x27; THEN &#x27;1.7&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;D&#x2b;&#x27; THEN &#x27;1.3&#x27;&#xd;&#xa;      WHEN FINAL_GRADE &#x3d; &#x27;D&#x27;  THEN &#x27;1.0&#x27;&#xd;&#xa;     WHEN FINAL_GRADE &#x3d; &#x27;F&#x27;  THEN &#x27;0.0&#x27;&#xd;&#xa;     ELSE NULL&#xd;&#xa;   END&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;       &#xa;       &#xa; </sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>586</xloc>
      <yloc>369</yloc>
      </entry>
    <entry>
      <name>change D type</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;-----------------------------------------------&#xd;&#xa;-- Chaning data types types to reflect relevant definitions&#xd;&#xa;-- &#xd;&#xa;--&#xd;&#xa;-----------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xa;ALTER TABLE PC&#xd;&#xa;ADD RC_GENDER int,&#xd;&#xa;ADD RC_ENROLLMENT_STATUS int,&#xd;&#xa;ADD RC_CLASS_CODE int,&#xd;&#xa;ADD RC_FINAL_GRADE float,&#xd;&#xa;ADD ACADEMIC_RISK int &#x3b;&#xa;&#xa;&#xa;&#xa;&#xa;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>704</xloc>
      <yloc>367</yloc>
      </entry>
    <entry>
      <name>Up RC Col</name>
      <description/>
      <type>SQL</type>
      <sql>--------------------------------------------------------------&#xd;&#xa;-- Type casting Derived columns.&#xd;&#xa;-- Will have to clean this section up and tighten the queries&#xd;&#xa;--&#xd;&#xa;--------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;UPDATE PC  set RC_GENDER&#x3d; CAST&#x28; GENDER AS UNSIGNED integer&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;ALTER TABLE PC &#xd;&#xa;DROP COLUMN GENDER&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;UPDATE PC  SET RC_ENROLLMENT_STATUS&#x3d; CAST&#x28;ENROLLMENT_STATUS AS UNSIGNED integer&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE PC &#xd;&#xa;DROP COLUMN ENROLLMENT_STATUS&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;UPDATE PC  set RC_CLASS_CODE&#x3d; CAST&#x28;CLASS_CODE AS UNSIGNED integer&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE PC DROP COLUMN CLASS_CODE&#x3b;&#xd;&#xa;&#xd;&#xa;UPDATE PC  SET RC_FINAL_GRADE&#x3d; CAST&#x28;FINAL_GRADE AS DECIMAL&#x28;10,6&#x29;&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE PC &#xd;&#xa;DROP COLUMN FINAL_GRADE&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;UPDATE PC  SET ACADEMIC_RISK&#x3d;&#xd;&#xa;  CASE WHEN RC_FINAL_GRADE &#x3c; 2 THEN 1&#xd;&#xa;  ELSE 2 &#xd;&#xa; END&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>830</xloc>
      <yloc>367</yloc>
      </entry>
    <entry>
      <name>PCS</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Second stage of merging. Includes merging Demographic BIO table,&#xd;&#xa;-- Course enrollment table and Derived metric from Gradebook&#xd;&#xa;-- RMN_Score &#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PCS&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE TABLE PCS SELECT  P.&#x2a;, C.RMN_SCORE &#xd;&#xa;FROM PC  P&#xd;&#xa;LEFT JOIN GRADES_SCORES C&#xd;&#xa;ON P.ALTERNATIVE_ID &#x3d;C.ALTERNATIVE_ID&#xd;&#xa;AND P.COURSE_ID&#x3d;C.COURSE_ID&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE PCS ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>959</xloc>
      <yloc>366</yloc>
      </entry>
    <entry>
      <name>Calculate Event Qty</name>
      <description/>
      <type>SQL</type>
      <sql>------------------------------------------------------------------------------------&#xd;&#xa;-- Add Indexes to speed up querying on merged tables.&#xd;&#xa;-- Crunching Sakai Event Log table for a semester to derive metric in similar lines&#xd;&#xa;-- to Gradebook. &#xd;&#xa;------------------------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_STUDENT_EVENT_QTY&#x3b; &#xd;&#xa;CREATE TABLE COURSE_STUDENT_EVENT_QTY&#xd;&#xa;SELECT S.COURSE_ID, RC_CLASS_CODE, P.ALTERNATIVE_ID, EVENT, COUNT&#x28;&#x2a;&#x29; AS QTY&#xd;&#xa;FROM  ACTIVITY S, PC P&#xd;&#xa;WHERE S.ALTERNATIVE_ID &#x3d; P.ALTERNATIVE_ID&#xd;&#xa;GROUP BY S.COURSE_ID,RC_CLASS_CODE, P.ALTERNATIVE_ID,EVENT&#xd;&#xa;ORDER BY S.COURSE_ID,RC_CLASS_CODE, P.ALTERNATIVE_ID,EVENT&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE COURSE_STUDENT_EVENT_QTY ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID, EVENT&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>960</xloc>
      <yloc>461</yloc>
      </entry>
    <entry>
      <name>Calculate Course Event Avg</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Counts the counts for a particular event in a course and &#xd;&#xa;-- calculates course average as mean.&#xd;&#xa;--&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xa;&#xa;CREATE TABLE COURSE_EVENT_AVG &#xd;&#xa;SELECT COURSE_ID, EVENT, SUM&#x28;QTY&#x29; AS TQTY, AVG&#x28;QTY &#x2a; 1.0&#x29; AS MEAN&#xd;&#xa;FROM   COURSE_STUDENT_EVENT_QTY&#xd;&#xa;GROUP BY COURSE_ID, EVENT&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE COURSE_EVENT_AVG ADD PRIMARY KEY &#x28;COURSE_ID, EVENT&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>767</xloc>
      <yloc>461</yloc>
      </entry>
    <entry>
      <name>Metric Event Ratio</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;-- Counts the counts for a student, course combination and derives a  &#xd;&#xa;-- ratio of student use against the average course usuage for the event&#xd;&#xa;--&#xd;&#xa;----------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;ALTER TABLE &#x60;COURSE_STUDENT_EVENT_QTY&#x60; &#xd;&#xa;ADD INDEX &#x60;COURSE_STUDENT_EVENT_QTY_idx&#x60; &#x28;&#x60;COURSE_ID&#x60; ASC, &#x60;EVENT&#x60; ASC&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE COURSE_STUDENT_EVENT_RATIO&#xd;&#xa;SELECT &#xd;&#xa;  v1.COURSE_ID, v1.ALTERNATIVE_ID, v1.EVENT,&#xd;&#xa;  v1.QTY, v2.MEAN, v1.QTY &#x2f; v2.MEAN AS RATIO&#xd;&#xa;FROM COURSE_STUDENT_EVENT_QTY AS v1 &#xd;&#xa;INNER JOIN COURSE_EVENT_AVG AS v2 &#xd;&#xa;ON v1.COURSE_ID &#x3d; v2.COURSE_ID&#xd;&#xa;AND v1.EVENT &#x3d; v2.EVENT&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE COURSE_STUDENT_EVENT_RATIO ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID, EVENT&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>582</xloc>
      <yloc>463</yloc>
      </entry>
    <entry>
      <name>Assmt_sub</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Assessment submitted event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xa;CREATE TABLE ASSMT_SUB&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_ASSMT_SUB,&#xd;&#xa;  Ratio AS R_ASSMT_SUB&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO &#xd;&#xa;WHERE EVENT &#x3d; &#x27;sam.assessment.submit&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE ASSMT_SUB ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>410</xloc>
      <yloc>564</yloc>
      </entry>
    <entry>
      <name>Asn_Read</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Assignemnt read event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xa;CREATE TABLE ASN_READ&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_ASN_READ,&#xd;&#xa;  Ratio AS R_ASN_READ&#xd;&#xa;FROM  COURSE_STUDENT_EVENT_RATIO&#xd;&#xa;WHERE EVENT &#x3d; &#x27;asn.read.assignment&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE ASN_READ ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>559</xloc>
      <yloc>564</yloc>
      </entry>
    <entry>
      <name>Asn_sub</name>
      <description/>
      <type>SQL</type>
      <sql>---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Assignment submission &#xd;&#xa;-- event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;CREATE TABLE ASN_SUB&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_ASN_SUB,&#xd;&#xa;  RATIO AS R_ASN_SUB&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO &#xd;&#xa;WHERE EVENT &#x3d; &#x27;asn.submit.submission&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE ASN_SUB ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>711</xloc>
      <yloc>565</yloc>
      </entry>
    <entry>
      <name>Con_read</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Content Read event &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xa;CREATE TABLE CONTENT_READ&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_CONTENT_READ,&#xd;&#xa;  RATIO AS R_CONTENT_READ&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO  &#xd;&#xa;WHERE EVENT &#x3d; &#x27;content.read&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE CONTENT_READ ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>857</xloc>
      <yloc>566</yloc>
      </entry>
    <entry>
      <name>Lessons</name>
      <description/>
      <type>SQL</type>
      <sql>---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Lessons View event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE LESSONS_VIEW&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_LESSONS_VIEW,&#xd;&#xa;  RATIO AS R_LESSONS_VIEW&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO &#xd;&#xa;WHERE EVENT &#x3d; &#x27;melete.section.read&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE LESSONS_VIEW ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>972</xloc>
      <yloc>570</yloc>
      </entry>
    <entry>
      <name>Forum_pst</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Forum Post event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE FORUM_POST&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  SUM&#x28;QTY&#x29; AS Q_FORUM_POST,&#xd;&#xa;  SUM&#x28;QTY &#x29;&#x2f;SUM&#x28;MEAN&#x29; AS R_FORUM_POST&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO  &#xd;&#xa;WHERE EVENT IN &#x28;&#x27;forums.new&#x27; , &#x27;forums.newtopic&#x27; , &#x27;forums.response&#x27;&#x29;&#xd;&#xa;GROUP BY COURSE_ID, ALTERNATIVE_ID&#x3b;&#xa;&#xd;&#xa;&#xd;&#xa;ALTER TABLE FORUM_POST ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>972</xloc>
      <yloc>663</yloc>
      </entry>
    <entry>
      <name>Forum_Read</name>
      <description/>
      <type>SQL</type>
      <sql>---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Forum Read  event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE FORUM_READ&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_FORUM_READ,&#xd;&#xa;  Ratio AS R_FORUM_READ&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO&#xd;&#xa;WHERE EVENT &#x3d;&#x27;forums.read&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE FORUM_READ ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>768</xloc>
      <yloc>661</yloc>
      </entry>
    <entry>
      <name>Output PCSM</name>
      <description/>
      <type>SQL</type>
      <sql>-----------------------------------------------------------------------------------------------------------&#xd;&#xa;-- Final Outpur table for the ETL to feed into Predictive modelling or Prediction Scoring flows.&#xd;&#xa;-- The merge includes tying Sakai Events table to already merged Demographics, Course Enrollment and&#xd;&#xa;-- Gradebook table &#x28;PCS&#x29;&#xd;&#xa;&#xd;&#xa;-- The query current takes around 4 minutes for execution.&#xd;&#xa;----------------------------------------------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PCSM&#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE PCSM&#xd;&#xa;SELECT C.ALTERNATIVE_ID, C.COURSE_ID, C.SUBJECT,C.ONLINE_FLAG,C.ENROLLMENT,C.RC_FINAL_GRADE,&#xd;&#xa;&#xd;&#xa;       C.PERCENTILE,C.SAT_VERBAL,C.SAT_MATH,&#xd;&#xa;     &#xd;&#xa;    C.APTITUDE_SCORE,C.AGE,C.RC_GENDER,C.RC_ENROLLMENT_STATUS,C.RC_CLASS_CODE,C.GPA_CUMULATIVE,&#xd;&#xa;&#xd;&#xa;     C.GPA_SEMESTER, C.STANDING,C.RMN_SCORE,C.RMN_SCORE AS RMN_SCORE_PARTIAL,&#xd;&#xa;       &#xd;&#xa;       R_CONTENT_READ,&#xd;&#xa;       &#xd;&#xa;       R_ASN_SUB,&#xd;&#xa;       &#xd;&#xa;       R_FORUM_POST,&#xd;&#xa;       &#xd;&#xa;       R_FORUM_READ,&#xd;&#xa;       &#xd;&#xa;       R_LESSONS_VIEW,&#xd;&#xa;      &#xd;&#xa;       R_ASSMT_TAKE,&#xd;&#xa;       &#xd;&#xa;       R_ASSMT_SUB,&#xd;&#xa;&#xd;&#xa;    R_ASN_READ,&#xd;&#xa;&#xd;&#xa;     R_SESSIONS,&#xd;&#xa;  &#xd;&#xa;     C.ACADEMIC_RISK&#xd;&#xa;FROM PCS C &#xd;&#xa;LEFT JOIN CONTENT_READ CT&#xd;&#xa;ON C.COURSE_ID &#x3d; CT.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; CT.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN SESSIONS SES&#xd;&#xa;ON C.COURSE_ID &#x3d; SES.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; SES.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN ASN_SUB ASN&#xd;&#xa;ON C.COURSE_ID &#x3d; ASN.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; ASN.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN FORUM_POST FP&#xd;&#xa;ON C.COURSE_ID &#x3d; FP.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; FP.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN FORUM_READ FR&#xd;&#xa;ON C.COURSE_ID &#x3d; FR.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; FR.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN LESSONS_VIEW LS&#xd;&#xa;ON C.COURSE_ID &#x3d; LS.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; LS.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN  ASSMT_TAKE ASSMT&#xd;&#xa;ON C.COURSE_ID &#x3d; ASSMT.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; ASSMT.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN  ASSMT_SUB ASMS&#xd;&#xa;ON C.COURSE_ID &#x3d; ASMS.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; ASMS.ALTERNATIVE_ID&#xd;&#xa;LEFT JOIN  ASN_READ ASNR&#xd;&#xa;ON C.COURSE_ID &#x3d; ASNR.COURSE_ID AND C.ALTERNATIVE_ID &#x3d; ASNR.ALTERNATIVE_ID&#x3b;&#xd;&#xa;&#xd;&#xa;UPDATE PCSM SET GPA_CUMULATIVE &#x3d; NULL WHERE GPA_CUMULATIVE&#x3d;0 AND RC_CLASS_CODE&#x3d;1&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>631</xloc>
      <yloc>798</yloc>
      </entry>
    <entry>
      <name>Assmt_tk</name>
      <description/>
      <type>SQL</type>
      <sql>---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Assessment taken event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE ASSMT_TAKE&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_ASSMT_TAKE,&#xd;&#xa;  RATIO AS R_ASSMT_TAKE&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO&#xd;&#xa;WHERE EVENT &#x3d; &#x27;sam.assessment.take&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE ASSMT_TAKE ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>411</xloc>
      <yloc>463</yloc>
      </entry>
    <entry>
      <name>Create temp Bio tables</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;--------------------------------------------------------------------------------------&#xd;&#xa;-- Kettle doesn&#x27;t seem to accept multiline comments. Hence using single line comments&#xd;&#xa;-- CREATE A temporary table DISTINCT_PERSONAL from the base PERSONAL H2&#x2f;MySQL table.   &#xd;&#xa;-- Check and eliminate duplicate entries if any by using Row number option.&#xd;&#xa;--------------------------------------------------------------------------------&#xd;&#xa;&#xa;DROP TABLE IF EXISTS DISTINCT_PERSONAL&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE TABLE DISTINCT_PERSONAL SELECT DISTINCT &#x2a; FROM PERSONAL&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE DISTINCT_PERSONAL ADD PRIMARY KEY &#x28;ALTERNATIVE_ID&#x29;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE DISTINCT_PERSONAL add APTITUDE_SCORE int&#x3b;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>333</xloc>
      <yloc>154</yloc>
      </entry>
    <entry>
      <name>AssignWeights_Grades</name>
      <description/>
      <type>JOB</type>
      <specification_method>filename</specification_method>
      <job_object_id/>
      <filename>&#x24;&#x7b;Internal.Job.Filename.Directory&#x7d;&#x2f;Sample_Pipeline1_ETL_Gradebook_AssignWeightsJob.kjb</filename>
      <jobname/>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Nothing</loglevel>
      <slave_server_name/>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <expand_remote_job>N</expand_remote_job>
      <create_parent_folder>N</create_parent_folder>
      <pass_export>N</pass_export>
      <force_separate_logging>N</force_separate_logging>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <set_append_logfile>N</set_append_logfile>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>879</xloc>
      <yloc>156</yloc>
      </entry>
    <entry>
      <name>Sessions</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;-- Create a separate ratio table for Session Login event  &#xd;&#xa;--&#xd;&#xa;---------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xa;CREATE TABLE SESSIONS&#xd;&#xa;SELECT &#xd;&#xa;  COURSE_ID,&#xd;&#xa;  ALTERNATIVE_ID,&#xd;&#xa;  QTY AS Q_SESSIONS,&#xd;&#xa;  RATIO AS R_SESSIONS&#xd;&#xa;FROM COURSE_STUDENT_EVENT_RATIO&#xd;&#xa;WHERE EVENT &#x3d; &#x27;pres.begin&#x27;&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE SESSIONS ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;&#xa;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>554</xloc>
      <yloc>657</yloc>
      </entry>
    <entry>
      <name>Add_Score</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;-------------------------------------------------------------------&#xd;&#xa;-- Calculating student individual scores for the gradable objects&#xd;&#xa;-- in the Gradebook extract&#xd;&#xa;-------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;ALTER TABLE GRADES ADD SCORE FLOAT&#x3b;&#xd;&#xa;&#xd;&#xa;UPDATE GRADES&#xd;&#xa;SET SCORE&#x3d; EARNED_POINTS&#x2f; MAX_POINTS&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>874</xloc>
      <yloc>265</yloc>
      </entry>
    <entry>
      <name>EffWt_Score</name>
      <description/>
      <type>SQL</type>
      <sql>--------------------------------------------------------------&#xd;&#xa;-- Calulating the average effective weighted score for the course.&#xd;&#xa;-- which avaerage of effective scores of all the students in the course.&#xd;&#xa;--&#xd;&#xa;--------------------------------------------------------------&#xd;&#xa;DROP TABLE IF EXISTS AUX_AVGCOURSE_EFFTWTSCORE&#x3b;&#xd;&#xa;CREATE TABLE AUX_AVGCOURSE_EFFTWTSCORE&#xd;&#xa;SELECT COURSE_ID&#xd;&#xa;      ,AVG&#x28;EFFWT_SCORE&#x29; AVG_EFFWT_SCORE&#xd;&#xa;FROM AUX2_AGGSCORES&#xd;&#xa;GROUP BY COURSE_ID&#xd;&#xa;ORDER BY COURSE_ID&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>413</xloc>
      <yloc>258</yloc>
      </entry>
    <entry>
      <name>AVG_Score</name>
      <description/>
      <type>SQL</type>
      <sql>--------------------------------------------------------------------&#xd;&#xa;-- Calculating a ratio of students effective weigthed score against &#xd;&#xa;-- the average effective score for the course. This gives a read of&#xd;&#xa;-- where the student stand in with respect to class average according&#xd;&#xa;-- to grading rubric &#xd;&#xa;--&#xd;&#xa;--&#xd;&#xa;--------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS GRADES_SCORES&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE TABLE GRADES_SCORES&#xd;&#xa;&#xd;&#xa;SELECT A.&#x2a; &#xd;&#xa;      ,AVG_EFFWT_SCORE&#xd;&#xa;      ,EFFWT_SCORE&#x2f;AVG_EFFWT_SCORE&#x2a;100 AS RMN_SCORE  &#xd;&#xa;FROM AUX2_AGGSCORES A, AUX_AVGCOURSE_EFFTWTSCORE M&#xd;&#xa;WHERE A.COURSE_ID&#x3d; M.COURSE_ID&#xd;&#xa;AND AVG_EFFWT_SCORE &#x3e; 0&#xd;&#xa;ORDER BY AVG_EFFWT_SCORE&#x3b;&#xd;&#xa;&#xd;&#xa;ALTER TABLE GRADES_SCORES ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>414</xloc>
      <yloc>367</yloc>
      </entry>
    <entry>
      <name>Agg_Scor</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;-------------------------------------------------------------------&#xd;&#xa;-- Calculating the actual score towards final grading by multiplying&#xd;&#xa;-- score and weight associated with it. Sum of all these scores for a&#xd;&#xa;-- student gives the final score against the grading rubric for the&#xd;&#xa;-- course.&#xd;&#xa;--&#xd;&#xa;-------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX1_AGGSCORES &#x3b;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;CREATE TABLE AUX1_AGGSCORES &#xd;&#xa;SELECT COURSE_ID,ALTERNATIVE_ID,SUM&#x28;WEIGHT&#x29; TOTAL_WEIGHT&#xd;&#xa;   ,SUM&#x28;SCORE &#x2a; WEIGHT&#x29;  as WEIGHTED_SCORE  &#xd;&#xa;FROM GRADES &#xd;&#xa;GROUP BY COURSE_ID,ALTERNATIVE_ID&#xd;&#xa;ORDER BY COURSE_ID,ALTERNATIVE_ID&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>743</xloc>
      <yloc>260</yloc>
      </entry>
    <entry>
      <name>AggScor2</name>
      <description/>
      <type>SQL</type>
      <sql>&#xd;&#xa;-------------------------------------------------------------------------------&#xd;&#xa;-- Calculates a effective weighted score by taking the ratio of student score &#xd;&#xa;-- against the Total weight.&#xd;&#xa;--&#xd;&#xa;-------------------------------------------------------------------------------&#xd;&#xa;DROP TABLE IF EXISTS AUX2_AGGSCORES&#x3b;&#xd;&#xa;&#xd;&#xa;CREATE TABLE AUX2_AGGSCORES &#xd;&#xa;SELECT COURSE_ID&#xd;&#xa;      ,ALTERNATIVE_ID&#xd;&#xa;      ,TOTAL_WEIGHT&#xd;&#xa;      ,WEIGHTED_SCORE &#xd;&#xa;      ,CASE&#xd;&#xa;         WHEN TOTAL_WEIGHT&#x3c;&#x3e;0 THEN WEIGHTED_SCORE &#x2f;TOTAL_WEIGHT &#xd;&#xa;         ELSE  0&#xd;&#xa;       END  AS EFFWT_SCORE&#xd;&#xa;FROM  AUX1_AGGSCORES&#x3b;</sql>
      <useVariableSubstitution>F</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>575</xloc>
      <yloc>260</yloc>
      </entry>
    <entry>
      <name>Drop temp tables</name>
      <description/>
      <type>SQL</type>
      <sql>--ALTER IGNORE TABLE table_name DROP INDEX index_name&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX1_AGGSCORES&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX2_AGGSCORES &#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX_AVGCOURSE_EFFTWTSCORE&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS DISTINCT_PERSONAL&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS DISTINCT_COURSE&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PC&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PCS&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS GRADES_SCORES&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS GRADES&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_STUDENT_EVENT_QTY&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_EVENT_AVG&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_STUDENT_EVENT_RATIO&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASN_READ&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASSMT_TAKE&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASSMT_SUB&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASN_SUB&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS CONTENT_READ&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS LESSONS_VIEW&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS FORUM_POST&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS FORUM_READ&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS SESSIONS&#x3b; &#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>793</xloc>
      <yloc>796</yloc>
      </entry>
    <entry>
      <name>Drop temp tables 2</name>
      <description/>
      <type>SQL</type>
      <sql>-------------------------------------------------------&#xd;&#xa;-- Droping temporary tables and retaining only base tables&#xd;&#xa;-------------------------------------------------------&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX1_AGGSCORES&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX2_AGGSCORES &#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS AUX_AVGCOURSE_EFFTWTSCORE&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS DISTINCT_PERSONAL&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS DISTINCT_COURSE&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PC&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS PCS&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS GRADES_SCORES&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS GRADES&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_STUDENT_EVENT_QTY&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_EVENT_AVG&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS COURSE_STUDENT_EVENT_RATIO&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASN_READ&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASSMT_TAKE&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASSMT_SUB&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS ASN_SUB&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS CONTENT_READ&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS LESSONS_VIEW&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS FORUM_POST&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS FORUM_READ&#x3b;&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS SESSIONS&#x3b;  &#xd;&#xa;&#xd;&#xa;&#xd;&#xa;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>337</xloc>
      <yloc>46</yloc>
      </entry>
    <entry>
      <name>Course Enrollment Details</name>
      <description/>
      <type>SQL</type>
      <sql>--------------------------------------------------------------------------------------------&#xd;&#xa;-- Eliminates duplicate entries for Course and Enrollment. This was necessary as there were &#xd;&#xa;-- repetitions in the csv files received. We use row numbers to identify&#xd;&#xa;-- duplicates and write distinct entries to a different table. &#xd;&#xa;--------------------------------------------------------------------------------------------&#xd;&#xa;&#xd;&#xa;DROP TABLE IF EXISTS DISTINCT_COURSE &#x3b;&#xd;&#xa;CREATE TABLE DISTINCT_COURSE &#xd;&#xa;SELECT distinct a.ALTERNATIVE_ID, a.COURSE_ID,b.SUBJECT, b.ENROLLMENT, b.ONLINE_FLAG, a.FINAL_GRADE, a.WITHDRAWAL_DATE &#xd;&#xa;FROM ENROLLMENT a, COURSE b&#xd;&#xa;WHERE a.COURSE_ID &#x3d; b.COURSE_ID &#x3b; &#xd;&#xa;&#xd;&#xa;ALTER TABLE DISTINCT_COURSE ADD PRIMARY KEY &#x28;ALTERNATIVE_ID, COURSE_ID&#x29;&#x3b;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>LAP_connect</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>694</xloc>
      <yloc>158</yloc>
      </entry>
  </entries>
  <hops>
    <hop>
      <from>Recodin</from>
      <to>change D type</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>change D type</from>
      <to>Up RC Col</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Calculate Event Qty</from>
      <to>Calculate Course Event Avg</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Calculate Course Event Avg</from>
      <to>Metric Event Ratio</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Assmt_sub</from>
      <to>Asn_Read</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Asn_Read</from>
      <to>Asn_sub</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Asn_sub</from>
      <to>Con_read</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Con_read</from>
      <to>Lessons</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Lessons</from>
      <to>Forum_pst</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Forum_pst</from>
      <to>Forum_Read</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Metric Event Ratio</from>
      <to>Assmt_tk</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Assmt_tk</from>
      <to>Assmt_sub</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Up RC Col</from>
      <to>PCS</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Forum_Read</from>
      <to>Sessions</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>EffWt_Score</from>
      <to>AVG_Score</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Agg_Scor</from>
      <to>AggScor2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>AggScor2</from>
      <to>EffWt_Score</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>AVG_Score</from>
      <to>PC</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>PC</from>
      <to>Recodin</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>PCS</from>
      <to>Calculate Event Qty</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>N</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>Add_Score</from>
      <to>Agg_Scor</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Drop temp tables 2</from>
      <to>Create temp Bio tables</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Calculate Aptitude Score</from>
      <to>Course Enrollment Details</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Create temp Bio tables</from>
      <to>Calculate Aptitude Score</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Course Enrollment Details</from>
      <to>AssignWeights_Grades</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Sessions</from>
      <to>Output PCSM</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>Output PCSM</from>
      <to>Drop temp tables</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>AssignWeights_Grades</from>
      <to>Add_Score</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>Drop temp tables 2</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
  </hops>
  <notepads>
    <notepad>
      <note>ETL process involving the Demographic Data</note>
      <xloc>4</xloc>
      <yloc>183</yloc>
      <width>271</width>
      <heigth>25</heigth>
      <fontname/>
      <fontsize>-1</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>ETL process involving the Course and Student Enrollments</note>
      <xloc>1005</xloc>
      <yloc>205</yloc>
      <width>350</width>
      <heigth>25</heigth>
      <fontname/>
      <fontsize>-1</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>ETL involving processing of Gradebook data&#xa;&#xa;1&#x29; Clean the gradebook data through a series of transformation&#xa;    and calculate scores for each of the gradebook entries.&#xa;&#xa;2&#x29; Calculation of scores considering all the gradable objects &#xa;    in the course. This results in generation of a powerful &#xa;    predictive metric called the RMN_SCORE.&#xa;</note>
      <xloc>9</xloc>
      <yloc>339</yloc>
      <width>380</width>
      <heigth>148</heigth>
      <fontname>Arial</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Merging the Demographics &#x28;P&#x29; table with Course &#x28;C&#x29; &#xa;and later the resultant &#x28;PC&#x29; table with the Gradebook &#xa;Scores table.&#xa;&#xa;Recoding and update related metrics like GENDER, &#xa;LETTER_GRADE, FULL&#x3f;PART TIME STATUS , CLASS, &#xa;ACADEMIC_RISK etc.</note>
      <xloc>1051</xloc>
      <yloc>509</yloc>
      <width>351</width>
      <heigth>116</heigth>
      <fontname>Arial</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Set the environmental variables used in the flow , with appropriate &#xa;table names based on the dataset considered for the ETL process.&#xa;&#xa;This technique enhances resuability and thereby helps in automation &#xa;of the process.</note>
      <xloc>519</xloc>
      <yloc>0</yloc>
      <width>416</width>
      <heigth>86</heigth>
      <fontname>Arial</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Sakai Events ETL process</note>
      <xloc>1054</xloc>
      <yloc>448</yloc>
      <width>245</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Depicts the student performance using the level of &#xa;participation of the students in the course through &#xa;the various Sakai Events available.&#xa;&#xa;THe following metrics are used for predictions&#xa;&#xa;SESSIONS OPENED,&#xa; CONTENT_READ,&#xa; ASSESSMENT_TAKE &#x2f; SUBMIT ,&#xa; ASSIGNMENT READ&#x2f;SUMIT , &#xa;LESSONS_VIEW&#xa;FORUM  READ &#x2f; POST.</note>
      <xloc>217</xloc>
      <yloc>656</yloc>
      <width>310</width>
      <heigth>192</heigth>
      <fontname>Arial</fontname>
      <fontsize>10</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Merge all the four transformed files &#x28; Demographic , Course, Gradebook, Sakai &#x29; into a single table which &#xa;will be used in training of the predictive model. </note>
      <xloc>768</xloc>
      <yloc>876</yloc>
      <width>624</width>
      <heigth>40</heigth>
      <fontname/>
      <fontsize>-1</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Merge Phase I</note>
      <xloc>1022</xloc>
      <yloc>349</yloc>
      <width>139</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Merge Phase II</note>
      <xloc>921</xloc>
      <yloc>811</yloc>
      <width>145</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Demographics ETL process</note>
      <xloc>3</xloc>
      <yloc>136</yloc>
      <width>257</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Parametrized approach.</note>
      <xloc>270</xloc>
      <yloc>0</yloc>
      <width>226</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>Course ETL process</note>
      <xloc>1003</xloc>
      <yloc>157</yloc>
      <width>191</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
    <notepad>
      <note>GradeBook ETL process</note>
      <xloc>5</xloc>
      <yloc>290</yloc>
      <width>227</width>
      <heigth>33</heigth>
      <fontname>Arial Black</fontname>
      <fontsize>12</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>Y</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>165</backgroundcolorgreen>
      <backgroundcolorblue>0</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>

</job>
